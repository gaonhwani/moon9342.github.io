<!DOCTYPE html>
<html lang="ko">
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous">
    </script>

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- Font Awesome CDN 설정 => 느림.. -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- JQuery fancybox plugin-->
    <link rel="stylesheet" href="/assets/built/fancybox.css">
    <script src="/assets/js/fancybox.js"></script>

    <!-- custom.css -->
    <link rel="stylesheet" href="/assets/built/custom.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">

    <!-- gist.css -->
    <link rel="stylesheet" href="/assets/built/better-gist-styles.css">

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--Dl Menu-->
    <script src="/assets/js/modernizr.custom.js"></script>
    <script src="/assets/js/jquery.dlmenu.js"></script>
    <script src="/assets/js/menu_main.js"></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-2687024418565562" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="얼큰우동TV, 쉽게배우는 IT(Programming,Machine Learning,금융)" />
    <link rel="shortcut icon" href="https://moon9342.github.io/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="IT Technical Training" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)" />
    <meta property="og:description" content="Python 기초강의는 여러 절로 구성되어 있습니다. Python 기초강의(1) - Introduction Python 기초강의(2) - Python 기본 Python 기초강의(3) - Python 제어문 Python 기초강의(4) - Python function Python 기초강의(5) - Python 연습문제(1) Python 기초강의(6) - Python 객체지향 Python 기초강의(7) - Python Magic Function Python 기초강의(8) - Python First Class Python 기초강의(9) -" />
    <meta property="og:url" content="https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2" />
    <meta property="og:image" content="https://moon9342.github.io/assets/built/images/python-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2020-05-09T01:40:00+09:00" />
    <meta property="article:modified_time" content="2020-05-09T01:40:00+09:00" />
    <meta property="article:tag" content="Python" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)" />
    <meta name="twitter:description" content="Python 기초강의는 여러 절로 구성되어 있습니다. Python 기초강의(1) - Introduction Python 기초강의(2) - Python 기본 Python 기초강의(3) - Python 제어문 Python 기초강의(4) - Python function Python 기초강의(5) - Python 연습문제(1) Python 기초강의(6) - Python 객체지향 Python 기초강의(7) - Python Magic Function Python 기초강의(8) - Python First Class Python 기초강의(9) -" />
    <meta name="twitter:url" content="https://moon9342.github.io/" />
    <meta name="twitter:image" content="https://moon9342.github.io/assets/built/images/python-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="IT Technical Training" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Python" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "IT Technical Training",
        "logo": "https://moon9342.github.io/"
    },
    "url": "https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2",
    "image": {
        "@type": "ImageObject",
        "url": "https://moon9342.github.io/assets/built/images/python-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2"
    },
    "description": "Python 기초강의는 여러 절로 구성되어 있습니다. Python 기초강의(1) - Introduction Python 기초강의(2) - Python 기본 Python 기초강의(3) - Python 제어문 Python 기초강의(4) - Python function Python 기초강의(5) - Python 연습문제(1) Python 기초강의(6) - Python 객체지향 Python 기초강의(7) - Python Magic Function Python 기초강의(8) - Python First Class Python 기초강의(9) -"
}
    </script>

    <!-- <script type="text/et-cetera" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/et-cetera">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <!-- 사용자 browser 확인 코드 - Chrome이 아니면 경고 메시지 출력 -->

    <script>
        var agent = navigator.userAgent.toLowerCase();
        var _iPhone = false;
        var _chrome = false;
        var result = false;
        if (agent.indexOf("iphone") != -1) {
            _iPhone = true;
        }
        if (agent.indexOf("chrome") != -1) {
            _chrome = true;
        }

        if( _iPhone || _chrome ) {
            result = true;
        }

        if( !result ) {
            alert("이 블로그는 Google Chrome Browser에 최적화 되어 있습니다 !!");
        }

    </script>

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="/">IT Technical Training</a>
            
        
        
            
<ul class="nav" role="menu">
<!--    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>-->
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
<!--
    <li class="nav-data-analysis-article" role="menuitem"><a href="/author/data-analysis/">Data Analysis(R)</a></li>
    <li class="nav-python-article" role="menuitem"><a href="/author/python/">Python</a></li>
    <li class="nav-python-article" role="menuitem"><a href="/tag/jekyll/">Jekyll</a></li>
    <li class="nav-miscellaneous-article" role="menuitem"><a href="/author/fragmentary-knowledge/">Miscellaneous Article</a></li>
-->
<!--
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
-->
    <li class="nav-python" role="menuitem">
        <a href="/tag/jekyll/">Jekyll Blog 생성</a>
    </li>
    <li class="nav-python" role="menuitem">
        <a href="/tag/python/">Python</a>
    </li>
    <li class="nav-data-science" role="menuitem">
        <a href="/tag/data-science/">Data Science</a>
    </li>
    <li class="nav-machine-learning" role="menuitem">
        <a href="/tag/machine-learning/">Machine Learning</a>
    </li>
    <li class="nav-python" role="menuitem">
        <a href="/tag/r/">R 기초강의</a>
    </li>
<!--    <li class="nav-python" role="menuitem">-->
<!--        <a href="/tag/angular/">Angular</a>-->
<!--    </li>-->
    <li class="nav-python" role="menuitem">
        <a href="/tag/et-cetera/">Et cetera</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">All Posts</a>
    </li>
</ul>

<!-- 아래 내용이 있으면 홈 화면 좌측 상단에 Navigation 버튼이 생성됨.. 굳이 필요없어서 comment 처리 -->

<!--
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
    <button class="dl-trigger">Open Menu</button>
    <ul class="dl-menu">
        <li><a href="https://moon9342.github.io/">Home</a></li>
        <li>
            <a href="#">About</a>
            <ul class="dl-submenu">
                <li style="text-align: center">
                    <img src="https://moon9342.github.io/assets/built/images/photo.jpg" alt="SungHoon Moon photo" class="author-photo">
                </li>
                <li>
                    <h4>SungHoon Moon</h4>
                    <p>Director of ATGLab. <br>Ph.D. in Computer Science</p>
                </li>
                <li><a href="https://moon9342.github.io/about/"><i class="fa fa-external-link"></i><span class="btn btn-inverse"> Learn More</span></a></li>
                <li>
                <a href="mailto:moon9342@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
            </li>
                
                
                
                
                
                
                
                
                
            </ul>
        </li>
        <li>
            <a href="#">Posts</a>
            <ul class="dl-submenu">
                <li><a href="https://moon9342.github.io/archive">All Posts</a></li>
                <li><a href="https://moon9342.github.io/author_archive">All Tags</a></li>
            </ul>
        </li>
        
    </ul>
</nav>
-->
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-front-end ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 8 May 2020"> 8 May 2020</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/python/'>PYTHON</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)</h1>
            </header>

            
<!--
            post에 cover image를 표시하지 않게 설정
            <figure class="post-full-image" style="background-image: url(/assets/built/images/python-logo.png)">
            </figure>
-->
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><span class="table-of-contents-list">Python 기초강의는 여러 절로 구성되어 있습니다. </span></p>
<ul class="table-of-contents-list">
    <li><a href="./python-lecture-python-introduction">Python 기초강의(1) - Introduction</a></li>
    <li><a href="./python-lecture-python-basic">Python 기초강의(2) - Python 기본</a></li>
    <li><a href="./python-lecture-python-control-statement">Python 기초강의(3) - Python 제어문</a></li>
    <li><a href="./python-lecture-python-function">Python 기초강의(4) - Python function</a></li>
    <li><a href="./python-lecture-python-program-exercise-1">Python 기초강의(5) - Python 연습문제(1)</a></li>
    <li><a href="./python-lecture-python-OOP">Python 기초강의(6) - Python 객체지향</a></li>
    <li><a href="./python-lecture-python-magic-function">Python 기초강의(7) - Python Magic Function</a></li>
    <li><a href="./python-lecture-python-first-class">Python 기초강의(8) - Python First Class</a></li>
    <li><a href="./python-lecture-python-closure">Python 기초강의(9) - Python Closure</a></li>
    <li><a href="./python-lecture-python-decorator">Python 기초강의(10) - Python Decorator</a></li>
    <li><a href="./python-lecture-python-generator">Python 기초강의(11) - Python Generator</a></li>
    <li><a href="./python-lecture-python-module">Python 기초강의(12) - Python Module</a></li>
    <li><a href="./python-lecture-python-exception">Python 기초강의(13) - Python Exception &amp; File</a></li>
    <li><a href="./python-lecture-python-oop-exercise">Python 기초강의(14) - Python 연습문제(2)</a></li>
    <li><a href="./python-lecture-python-web-basic-jquery">Web basic &amp; jQuery(Front End Web Application)</a></li>
    <li><a href="./python-lecture-python-django-introduction">Python Django 웹 프레임워크(1) - introduction</a></li>
    <li><a href="./python-lecture-python-django-poll-project-1">Python Django 웹 프레임워크(2) - Poll project 개발(1)</a></li>
    <li><a href="./python-lecture-python-django-poll-project-2">Python Django 웹 프레임워크(3) - Poll project 개발(2)</a></li>
    <li><a href="./python-lecture-python-django-poll-project-3">Python Django 웹 프레임워크(4) - Poll project 개발(3)</a></li>
    <li><a href="./python-lecture-python-django-poll-project-4">Python Django 웹 프레임워크(5) - Poll project 개발(4)</a></li>
    <li><a href="./python-lecture-python-django-poll-project-5">Python Django 웹 프레임워크(6) - Poll project 개발(5)</a></li>
    <li><a href="./python-lecture-python-django-lecture-sample-project_1">Python Django 웹 프레임워크(7) - LectureSample project 개발(1)</a></li>
    <li><a href="./python-lecture-python-django-lecture-sample-project_2">Python Django 웹 프레임워크(8) - LectureSample project 개발(2)</a></li>


</ul>

<hr />

<p><strong class="subtitle_fontAwesome">Lecture Sample project 개발(2)</strong></p>

<p>이번에는 이전에 구현한 Lecture Sample Project에 다음의 기능을 추가해 보겠습니다.</p>

<ul>
  <li>Auth module의 User class 확장과 Auth class와 User Define BackEnd class를
이용한 사용자 관리 및 인증</li>
</ul>

<p><strong class="subtitle2_fontAwesome">application 추가</strong></p>

<p>working directory를 LectureSampleProject 폴더로 변경합니다.</p>
<blockquote>
  <p><strong>C:/python-Django&gt; cd LectureSampleProject</strong></p>
</blockquote>

<p>users application을 생성합니다.</p>
<blockquote>
  <p><strong>C:/python-Django/LectureSampleProject&gt; python manage.py startapp users</strong></p>
</blockquote>

<p>이후부터는 PyCharm을 이용해 작업을 진행합니다.</p>

<p><strong class="subtitle2_fontAwesome">project 환경설정</strong></p>

<p><code class="highlighter-rouge">INSTALLED_APPS</code> 부분에 <code class="highlighter-rouge">users</code> application을 등록합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'bbs.apps.BbsConfig'</span><span class="p">,</span>
    <span class="s">'bootstrap4'</span><span class="p">,</span>
    <span class="s">'users.apps.UsersConfig'</span>
<span class="p">]</span>

</code></pre></div></div>

<p>사용자 관리를 위해서 Auth module의 User class를 이용합니다. 그런데 이 User class를
직접사용하는게 아닌 AbstractUser class를 상속해서 사용하려 합니다. 
확장한 class는 Member라는 이름의 class로 하겠습니다.</p>

<p>추후에 사용자 인증은 User class가 아닌 이 상속된 Member class를 이용할 것이고 이에 
대한 설정을 settings.py에 추가적으로 넣어야 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># 인증에 사용할 class를 지정( app이름.class이름 )</span>
<span class="n">AUTH_USER_MODEL</span> <span class="o">=</span> <span class="s">'users.Member'</span>

<span class="c"># 인증에 사용할 사용자 정의 BACKEND</span>
<span class="c"># 사용자 정의 BACKEND를 Django의 기본 ModelBackend 이전에 넣어줍니다.</span>
<span class="c"># 일반적으로 타 사이트에 인증이 된 경우 우리 site도 인증된 사용자로 처리할 경우</span>
<span class="c"># 이 방식을 이용합니다. </span>

<span class="n">AUTHENTICATION_BACKENDS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c"># 'users.my_auth.UserBackend',</span>
    <span class="s">'django.contrib.auth.backends.ModelBackend'</span><span class="p">,</span>
<span class="p">]</span>

</code></pre></div></div>

<hr />

<p><strong class="subtitle2_fontAwesome">Model 생성</strong></p>

<p>Model을 생성하기 위해 users application 내의 <code class="highlighter-rouge">models.py</code> 파일에 다음과 같은 내용을
입력합니다. 여기서 주의해야 할 점은 제공된 User class를 그대로 사용하지 않고
User class를 확장해서 Member class를 정의해서 사용한다는 것입니다. 단순히 
User class를 이용해도 되지만 만약 추가적인 필드(전화번호, 사진이미지)가 필요하다면
제공된 User class를 확장해서 사용하며 이 경우 4가지 정도의 방법이 있습니다.
여기서는 간단하게 AbstractUser class를 상속하는 방식으로 진행하겠습니다.
(이것외에 프록시 모델 기법, ForeignKey 이용, AbstractBaseUser를 상속하는 방법이 있습니다.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">AbstractUser</span>


<span class="k">class</span> <span class="nc">Member</span><span class="p">(</span><span class="n">AbstractUser</span><span class="p">):</span>
    <span class="n">mobile</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s">'images/'</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>로그인시 데이터 입력에 ModelForm을 사용하기 위해 <code class="highlighter-rouge">forms.py</code>에 다음의 class를 정의합니다. 회원가입을 위한
ModelForm은 추후에 추가로 작성합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Member</span>


<span class="k">class</span> <span class="nc">LoginForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">'Password'</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">PasswordInput</span><span class="p">(</span>
            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
                <span class="s">'class'</span><span class="p">:</span> <span class="s">'form-control'</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Member</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'username'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">]</span>


</code></pre></div></div>

<p>Admin Page에 반영하기 위해서 users application 내의 <code class="highlighter-rouge">admin.py</code>에 class를 등록합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Member</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Member</span><span class="p">)</span>

</code></pre></div></div>

<p>사용자 관리 기능(users application)을 추가했기 때문에 이제 게시판은 로그인한 사람만
사용할 수 있고 게시글의 작성자와 댓글의 작성자는 당연히 현재 로그인한 사람을 기준으로
자동설정되어야 합니다.</p>

<p>이를 위해 bbs application의 <code class="highlighter-rouge">models.py</code>를 다음과 같이 수정하여 Foreign Key를
설정합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">users.models</span> <span class="kn">import</span> <span class="n">Member</span>


<span class="k">class</span> <span class="nc">Board</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">b_title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">b_author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Member</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">b_content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="c"># b_date = models.DateTimeField()</span>
    <span class="n">b_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># 자동갱신</span>
    <span class="n">b_comment_count</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">b_like_count</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_title</span>


<span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">c_author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Member</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">c_content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Board</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_content</span>


</code></pre></div></div>

<p>Database 변경사항을 반영하기 위해서 migration 초안을 생성하고 설정된 Schema를 
Database에 실제로 적용해야 합니다.</p>

<p>기존에 사용하고 있는 Database file과 migration 초안은 삭제하고 Database를 다시
생성합니다.</p>

<p>한가지 주의해야 할 점은 위의 코드를 사용하기 위해서는 <code class="highlighter-rouge">settings.py</code> 안에 위에서 언급한
<code class="highlighter-rouge">AUTH_USER_MODEL = 'users.Member'</code> 코드가 반드시 존재해야 한다는 것입니다.</p>

<p>마이그레이션 초안을 생성하기 위해서 다음과 같이 실행합니다.</p>
<blockquote>
  <p><strong>C:/python-Django/LectureSampleProject&gt; python manage.py makemigrations</strong></p>
</blockquote>

<p>설정된 Schema를 Database에 적용하기 위해서 다음과 같이 실행합니다.</p>
<blockquote>
  <p><strong>C:/python-Django/LectureSampleProject&gt; python manage.py migrate</strong></p>
</blockquote>

<p>관리자 page에 접속하기 위한 계정을 생성합니다.</p>
<blockquote>
  <p><strong>C:/python-Django/LectureSampleProject&gt; python manage.py createsuperuser</strong></p>
</blockquote>

<p>project가 정상적으로 생성되었는지 확인하기 위해 내장서버를 이용해 deploy합니다.</p>
<blockquote>
  <p><strong>C:/python-Django/LectureSampleProject&gt; python manage.py runserver</strong></p>
</blockquote>

<p>데이터베이스가 정상적으로 생성되었는지 확인하고 넘어가는게 좋습니다.
<a href="https://sqlitebrowser.org/" target="_blank">DB Browser for SQLite</a>와 같은
툴을 이용하면 쉽게 데이터베이스를 확인할 수 있습니다. 
MySQL같은 경우 <a href="https://www.toadworld.com/downloads" target="_blank">Toad for MySQL</a>을 사용하면 됩니다.</p>

<hr />

<p><strong class="subtitle2_fontAwesome">Admin Page 접속 확인</strong></p>

<p><code class="highlighter-rouge">http://localhost:8000/admin</code>으로 접속 후 관리자 계정으로 로그인</p>

<hr />

<p><strong class="subtitle2_fontAwesome">회원가입 및 로그인 기능 구현</strong></p>

<p>Project의 ROOT_URLCONF인 <code class="highlighter-rouge">urls.py</code>파일을 다음과 같이 수정하여 계층적으로 
URL을 관리하기 위한 설정을 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">django.views.generic.base</span> <span class="kn">import</span> <span class="n">TemplateView</span>
<span class="kn">from</span> <span class="nn">django.conf.urls.static</span> <span class="kn">import</span> <span class="n">static</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">TemplateView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s">'index.html'</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">'home'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'admin/'</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'bbs/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'bbs.urls'</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'users/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'users.urls'</span><span class="p">))</span>
<span class="p">]</span> <span class="o">+</span> <span class="n">static</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_URL</span><span class="p">,</span> <span class="n">document_root</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">)</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">/users/</code> 경로로 들어오는 모든 request를 처리하기 위해서 
users application의 <code class="highlighter-rouge">urls.py</code>파일을 다음과 같이 작성합니다.</p>

<p>일단 urlpatterns을 정의하고 구현시 지금 당장 필요하지 않은 부분은 주석으로 처리하면서 
코드 작성을 진행하면 될 듯 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># users/urls.py</span>

<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s">'users'</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'login/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'loginProcess/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login_process</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login_process'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'signup/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">signup</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'signup'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'signupProcess/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">signup_process</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'signup_process'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'logout/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'logout'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'update/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'update'</span><span class="p">),</span>
<span class="p">]</span>

</code></pre></div></div>

<p>맨 처음 작업할 기능은 login, logout 입니다.</p>

<p>만약 로그인한 상태로 Home Page로 이동하게 되면 환영메시지를 출력하고 게시판 들어가기 버튼과 로그아웃 버튼을 활성화 시키고 로그인하지 않은
상태면 로그인이 필요하다는 메시지를 출력하고 로그인 버튼을 활성화시키면 될 듯 합니다. 따라서 우리의 Home Page는 다음과 같이 수정하면 됩니다.</p>

<p>다음은 수정된 <code class="highlighter-rouge">index.html</code> 내용입니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"ko"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>LectureSampleProject<span class="nt">&lt;/title&gt;</span>

  <span class="c">&lt;!-- Bootstrap core CSS --&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span>
        <span class="na">href=</span><span class="s">"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>
        <span class="na">integrity=</span><span class="s">"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"</span>
        <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>

  <span class="c">&lt;!-- Custom styles for this template --&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"/static/css/cover.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body</span> <span class="na">class=</span><span class="s">"text-center"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cover-container d-flex w-100 h-100 p-3 mx-auto flex-column"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"masthead mb-auto"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"inner"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"masthead-brand"</span><span class="nt">&gt;</span>Lecture Sample Project<span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/header&gt;</span>

  <span class="nt">&lt;main</span> <span class="na">role=</span><span class="s">"main"</span> <span class="na">class=</span><span class="s">"inner cover"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;</span>
      {% if request.user.is_authenticated %}
      {{ request.user.username }}님 환영합니다.
      {% else %}
      로그인이 필요합니다.
      {% endif %}
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;</span>
      {% if request.user.is_authenticated %}
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"bbs/list/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-primary"</span><span class="nt">&gt;</span>Enter BBS<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"users/logout/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-danger"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;</span>
      {% else %}
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"users/login/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-warning"</span><span class="nt">&gt;</span>Login<span class="nt">&lt;/a&gt;</span>
      {% endif %}
    <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/main&gt;</span>

  <span class="nt">&lt;footer</span> <span class="na">class=</span><span class="s">"mastfoot mt-auto"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"inner"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p&gt;</span>Copyright 2020<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/footer&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>




</code></pre></div></div>

<p>간단한 기능인 logout 기능부터 살펴보도록 하겠습니다. 먼저 users application의 <code class="highlighter-rouge">urls.py</code> 파일을 수정해야 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s">'users'</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'login/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login'</span><span class="p">),</span>
    <span class="c"># path('loginProcess/', views.login_process, name='login_process'),</span>
    <span class="c"># path('signup/', views.signup, name='signup'),</span>
    <span class="c"># path('signupProcess/', views.signup_process, name='signup_process'),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'logout/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'logout'</span><span class="p">),</span>
    <span class="c"># path('update/', views.update, name='update'),</span>
<span class="p">]</span>

</code></pre></div></div>

<p>users application의 <code class="highlighter-rouge">views.py</code> 파일을 수정해야 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> \
    <span class="n">login</span> <span class="k">as</span> <span class="n">django_login</span><span class="p">,</span> \
    <span class="n">logout</span> <span class="k">as</span> <span class="n">django_logout</span>
<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">LoginForm</span>


<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">login_form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'users/login.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'login_form'</span><span class="p">:</span> <span class="n">login_form</span>
    <span class="p">})</span>


<span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">django_logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'home'</span><span class="p">)</span>

</code></pre></div></div>

<p>로그인이 되어 있는 경우 우리 Home Page에서 <code class="highlighter-rouge">Enter BBS</code> 버튼을 클릭하면 게시판의
list를 보여주는 화면으로 이동하게 되는데 <code class="highlighter-rouge">/bbs/list/</code>로 이동(편의상 이동이란 표현을 사용하겠습니다.)할 때 
로그인이 되어 있으면 list를 출력하지만 그렇지 않은 경우 login 화면으로 이동하면 될 듯 합니다.</p>

<p>정상적인 형태로 link를 타고 오는게 아니라 직접 게시판 url을 입력할 경우를 대비해서 다음과 같이 처리합니다.</p>

<p>bbs application의 <code class="highlighter-rouge">views.py</code> 안의 <code class="highlighter-rouge">b_list</code> 함수를 다음과 같이 수정합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">b_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
        <span class="n">posts</span> <span class="o">=</span> <span class="n">Board</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-id'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'bbs/list.html'</span><span class="p">,</span> <span class="p">{</span>
            <span class="s">'posts'</span><span class="p">:</span> <span class="n">posts</span>
        <span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">login_form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'users/login.html'</span><span class="p">,</span> <span class="p">{</span>
            <span class="s">'login_form'</span><span class="p">:</span> <span class="n">login_form</span>
        <span class="p">})</span>

</code></pre></div></div>

<p>users application의 template으로 <code class="highlighter-rouge">login.html</code> 파일을 생성해야 합니다. 이 파일의 내용은 bootstrap의 example을
이용하겠습니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


{% extends 'base.html' %}
{% load bootstrap4 %}

{% block html_header %}
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.bd-placeholder-img</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.125rem</span><span class="p">;</span>
    <span class="py">text-anchor</span><span class="p">:</span> <span class="nb">middle</span><span class="p">;</span>
    <span class="nl">-webkit-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">-moz-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">@media</span> <span class="p">(</span><span class="n">min-width</span><span class="p">:</span> <span class="m">768px</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">.bd-placeholder-img-lg</span> <span class="p">{</span>
      <span class="nl">font-size</span><span class="p">:</span> <span class="m">3.5rem</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="c">&lt;!-- Custom styles for this template --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"/static/css/signin.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
{% endblock %}

{% block html_body %}

<span class="nt">&lt;main</span> <span class="na">class=</span><span class="s">"form-signin"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/users/loginProcess/"</span>
        <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"h3 mb-3 fw-normal"</span><span class="nt">&gt;</span>로그인하세요<span class="nt">&lt;/h1&gt;</span>

    {% bootstrap_form login_form %}

    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"w-100 btn btn-lg btn-primary"</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>로그인<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"mt-5 mb-3 text-muted"</span><span class="nt">&gt;</span><span class="ni">&amp;copy;</span> 2017–2021<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/main&gt;</span>

{% endblock %}




</code></pre></div></div>

<p>로그인 버튼을 클릭하면 로그인 처리를 수행해야 하기 때문에 <code class="highlighter-rouge">urls.py</code>와 <code class="highlighter-rouge">views.py</code> 파일을 수정합니다.</p>

<p>아래의 내용은 <code class="highlighter-rouge">urls.py</code> 입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s">'users'</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'login/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'loginProcess/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login_process</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login_process'</span><span class="p">),</span>
    <span class="c"># path('signup/', views.signup, name='signup'),</span>
    <span class="c"># path('signupProcess/', views.signup_process, name='signup_process'),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'logout/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'logout'</span><span class="p">),</span>
    <span class="c"># path('update/', views.update, name='update'),</span>
<span class="p">]</span>

</code></pre></div></div>

<p>아래의 내용은 <code class="highlighter-rouge">views.py</code> 입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> \
    <span class="n">login</span> <span class="k">as</span> <span class="n">django_login</span><span class="p">,</span> \
    <span class="n">logout</span> <span class="k">as</span> <span class="n">django_logout</span>
<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">LoginForm</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>


<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">login_form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'users/login.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'login_form'</span><span class="p">:</span> <span class="n">login_form</span>
    <span class="p">})</span>


<span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">django_logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'home'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">login_process</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>

        <span class="n">login_form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>

        <span class="n">username</span> <span class="o">=</span> <span class="n">login_form</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">login_form</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'password'</span><span class="p">]</span>

        <span class="c"># 가져온 username과 password에 해당하는 User가 있는지 판단</span>
        <span class="c"># 존재할경우 user변수에는 User인스턴스가 할당되며,</span>
        <span class="c"># 존재하지 않으면 None이 할당된다</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">django_login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'home'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">'로그인 실패. 다시 시도 해보세요.'</span><span class="p">)</span>


</code></pre></div></div>

<p>여기까지 진행되면 기본적인 로그인, 로그아웃 처리가 완성됩니다. 이제 회원가입을 처리해보도록 하겠습니다. 타 사이트에서 인증받을 경우
우리 사이트에서 자동으로 회원가입이 되도록 하는 기능을 추후에 프로젝트 등에서 추가해보시기 바랍니다. 여기서는 기본적인 데이터를
입력받아서 회원가입하는 형태로 진행하겠습니다.</p>

<p>회원가입 링크는 Home Page에 만들도록 하겠습니다. <code class="highlighter-rouge">index.html</code>을 간단히 수정합니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"ko"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>LectureSampleProject<span class="nt">&lt;/title&gt;</span>

  <span class="c">&lt;!-- Bootstrap core CSS --&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span>
        <span class="na">href=</span><span class="s">"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"</span>
        <span class="na">integrity=</span><span class="s">"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"</span>
        <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>

  <span class="c">&lt;!-- Custom styles for this template --&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"/static/css/cover.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body</span> <span class="na">class=</span><span class="s">"text-center"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"cover-container d-flex w-100 h-100 p-3 mx-auto flex-column"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"masthead mb-auto"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"inner"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"masthead-brand"</span><span class="nt">&gt;</span>Lecture Sample Project<span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/header&gt;</span>

  <span class="nt">&lt;main</span> <span class="na">role=</span><span class="s">"main"</span> <span class="na">class=</span><span class="s">"inner cover"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;</span>
      {% if request.user.is_authenticated %}
      {{ request.user.username }}님 환영합니다.
      {% else %}
      로그인이 필요합니다.
      {% endif %}
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;</span>
      {% if request.user.is_authenticated %}
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"bbs/list/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-primary"</span><span class="nt">&gt;</span>Enter BBS<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"users/logout/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-danger"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;</span>
      {% else %}
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"users/login/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-warning"</span><span class="nt">&gt;</span>Login<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"users/signup/"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-success"</span><span class="nt">&gt;</span>회원가입<span class="nt">&lt;/a&gt;</span>
      {% endif %}
    <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/main&gt;</span>

  <span class="nt">&lt;footer</span> <span class="na">class=</span><span class="s">"mastfoot mt-auto"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"inner"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p&gt;</span>Copyright 2020<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/footer&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>




</code></pre></div></div>

<p><code class="highlighter-rouge">urls.py</code>를 수정합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s">'users'</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'login/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'loginProcess/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login_process</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'login_process'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'signup/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">signup</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'signup'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'signupProcess/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">signup_process</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'signup_process'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'logout/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'logout'</span><span class="p">),</span>
    <span class="c"># path('update/', views.update, name='update'),</span>
<span class="p">]</span>

</code></pre></div></div>

<p>이제 회원가입을 위한 ModelForm을 생성하러 <code class="highlighter-rouge">forms.py</code> 파일을 수정해야 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Member</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.forms</span> <span class="kn">import</span> <span class="n">UserCreationForm</span>


<span class="k">class</span> <span class="nc">MemberForm</span><span class="p">(</span><span class="n">UserCreationForm</span><span class="p">):</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Member</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'username'</span><span class="p">,</span> <span class="s">'email'</span><span class="p">,</span> <span class="s">'mobile'</span><span class="p">,</span> <span class="s">'password1'</span><span class="p">,</span> <span class="s">'password2'</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">LoginForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">label</span><span class="o">=</span><span class="s">'Password'</span><span class="p">,</span>
        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">PasswordInput</span><span class="p">(</span>
            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
                <span class="s">'class'</span><span class="p">:</span> <span class="s">'form-control'</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Member</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'username'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">]</span>


</code></pre></div></div>

<p><code class="highlighter-rouge">views.py</code> 파일을 수정합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">signup</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">member_form</span> <span class="o">=</span> <span class="n">MemberForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'users/signup.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'member_form'</span><span class="p">:</span> <span class="n">member_form</span>
    <span class="p">})</span>

</code></pre></div></div>

<p>회원가입을 위한 template인 <code class="highlighter-rouge">signup.html</code>을 작성합니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


{% extends 'base.html' %}
{% load bootstrap4 %}

{% block html_header %}
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.bd-placeholder-img</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.125rem</span><span class="p">;</span>
    <span class="py">text-anchor</span><span class="p">:</span> <span class="nb">middle</span><span class="p">;</span>
    <span class="nl">-webkit-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">-moz-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">@media</span> <span class="p">(</span><span class="n">min-width</span><span class="p">:</span> <span class="m">768px</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">.bd-placeholder-img-lg</span> <span class="p">{</span>
      <span class="nl">font-size</span><span class="p">:</span> <span class="m">3.5rem</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="c">&lt;!-- Custom styles for this template --&gt;</span>
<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"/static/css/signin.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
{% endblock %}

{% block html_body %}

<span class="nt">&lt;main</span> <span class="na">class=</span><span class="s">"form-signin"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/users/signupProcess/"</span>
        <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"h3 mb-3 fw-normal"</span><span class="nt">&gt;</span>회원가입<span class="nt">&lt;/h1&gt;</span>

    {% bootstrap_form member_form %}

    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"w-100 btn btn-lg btn-success"</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>회원가입<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"mt-5 mb-3 text-muted"</span><span class="nt">&gt;</span><span class="ni">&amp;copy;</span> 2017–2021<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/main&gt;</span>

{% endblock %}




</code></pre></div></div>

<p>이제 실제 회원가입 기능을 하면 <code class="highlighter-rouge">views.py</code>의 함수를 살펴보도록 하겠습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">signup_process</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>
        <span class="n">member_form</span> <span class="o">=</span> <span class="n">MemberForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">member_form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="n">new_user</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">member_form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s">"username"</span><span class="p">],</span>
                                                  <span class="n">email</span><span class="o">=</span><span class="n">member_form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s">'email'</span><span class="p">],</span>
                                                  <span class="n">password</span><span class="o">=</span><span class="n">member_form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s">'password1'</span><span class="p">],</span>
                                                  <span class="n">mobile</span><span class="o">=</span><span class="n">member_form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s">'mobile'</span><span class="p">])</span>
            <span class="n">django_login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">new_user</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'home'</span><span class="p">)</span>

</code></pre></div></div>

<p>여기까지 작성하면 회원가입 기능까지 동작하게 됩니다. 현재 회원가입, 로그인, 로그아웃 기능까지 구현했습니다. 회원정보 상세보기와 수정은
배운내용을 기반으로 개인적으로 작성해보세요. 지금까지의 내용을 잘 따라오셨으면 어떻게 해야 할지 감(?)이 오실거라 생각됩니다.</p>

<p>마지막 단계가 남았습니다. 글을 쓸때 현재 로그인 한 사람의 이름으로 글 작성자가 자동으로 설정되어야 합니다. 또한 
글 삭제와 수정 역시 본인이 작성한 글에 대해서만 기능이 동작하도록 해야 합니다.</p>

<hr />

<p><strong class="subtitle2_fontAwesome">게시판 기능 수정(새글 작성)</strong></p>

<p>게시판의 새글 작성 기능부터 손봐야 할 듯 합니다. 현재까지 구현된 내용으로 실행하면 새글 작성 클릭 시 author 부분이 Foreign key로
설정되어 있기 때문에 author를 선택할 수 있는 select box로 표현될 것입니다. 이 부분부터 수정하고 가도록 하죠. 그러면
새글 작성 화면에서 현재 로그인한 사람의 username으로 author부분을 고정시키면 될 듯 합니다.</p>

<p>구현 방법은 여러가지가 있을 수 있는데 여기서는 너무 어렵지 않게 우리가 배운 jQuery를 활용하는 쪽으로 진행하겠습니다. jQuery는
보안상 약간 우려되는 부분이 있지만 코드가 직관적이기 때문에 이해하는데 어렵지는 않을 듯 합니다.</p>

<p>먼저 <code class="highlighter-rouge">views.py</code> 파일부터 손봐야 할 듯 합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">b_create</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c"># POST 방식</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="c"># ModelForm을 사용하지 않으면</span>
        <span class="c"># class의 instance를 만들어서 save() 호출</span>
        <span class="c"># board = Board()</span>
        <span class="c"># board.b_title = request.POST['b_title']</span>
        <span class="c"># board.save()</span>

        <span class="n">board_form</span> <span class="o">=</span> <span class="n">BoardForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">board_form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="n">new_post</span> <span class="o">=</span> <span class="n">board_form</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">commit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="c"># 필요한 경우 field에 값을 수동으로 설정할 수 있다.</span>
            <span class="c"># 예) new_post.b_like_count = 100</span>
            <span class="n">new_post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s">'bbs:b_list'</span><span class="p">)</span>

    <span class="c"># GET 방식</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="n">board_form</span> <span class="o">=</span> <span class="n">BoardForm</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="p">{</span><span class="s">'b_author'</span><span class="p">:</span> <span class="n">member</span><span class="p">})</span>
        <span class="n">board_form</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s">'b_author'</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'disabled'</span><span class="p">:</span> <span class="s">'disabled'</span>
        <span class="p">})</span>
        <span class="c"># 로그인한 사람의 username으로 author부분을 설정한 후 수정할 수 없도록</span>
        <span class="c"># disabled로 설정합니다.</span>
        <span class="c"># 단, disabled로 설정된 field는 submit이 되지 않기 때문에 jQuery를 이용해</span>
        <span class="c"># submit하기 전에 disabled를 해제하고 submit하는 방식으로 우회합니다.</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'bbs/create.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'board_form'</span><span class="p">:</span> <span class="n">board_form</span>
    <span class="p">})</span>

</code></pre></div></div>

<p>그 다음 수정해야 할 파일은 <code class="highlighter-rouge">create.html</code> 입니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


{% extends 'base.html' %}
{% load bootstrap4 %}
{% block html_body %}

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/static/js/menu_btn.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>새글 작성<span class="nt">&lt;/h1&gt;</span>

  <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    {# {{ board_form }} #}
    {% bootstrap_form board_form %}
    <span class="nt">&lt;br&gt;</span>
    {#        기존의 submit button 방식으로는 처리하기가 좀 복잡해서 #}
    {#        간단하게 처리할 수 있는 jQuery방식으로 우회하자 #}
    {#        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="err">#}</span> 
    <span class="err">{#</span>                <span class="na">class=</span><span class="s">"btn btn-primary"</span><span class="nt">&gt;</span>등록<span class="nt">&lt;/button&gt;</span> #}
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
            <span class="na">class=</span><span class="s">"btn btn-primary"</span>
            <span class="na">id=</span><span class="s">"post_create_btn"</span><span class="nt">&gt;</span>등록<span class="nt">&lt;/button&gt;</span>

    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
            <span class="na">class=</span><span class="s">"btn btn-secondary"</span>
            <span class="na">id=</span><span class="s">"board_list_btn"</span><span class="nt">&gt;</span>리스트로 돌아가기<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/div&gt;</span>

{% endblock %}



</code></pre></div></div>

<p>jQuery를 이용하여 submit 처리를 해야 하기 때문에 <code class="highlighter-rouge">menu_btn.js</code> 파일을 수정합니다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// 새글쓰기 버튼 클릭시</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'#new_post_btn'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'/bbs/create/'</span>
  <span class="p">})</span>

  <span class="c1">// 새글 등록 버튼 클릭시(실제 새글을 저장하기 위한 submit을 수행할 때)</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'#post_create_btn'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'#id_b_author'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'form'</span><span class="p">).</span><span class="nx">submit</span><span class="p">()</span>
  <span class="p">})</span>

  <span class="c1">// 나머지 부분은 동일</span>
  
<span class="p">})</span>

</code></pre></div></div>

<hr />

<p><strong class="subtitle2_fontAwesome">게시판 기능 수정(상세보기)</strong></p>

<p>이번에는 게시글 상세보기 화면을 수정하도록 하죠.</p>

<p>제일 먼저 수정해야 할 파일은 <code class="highlighter-rouge">views.py</code> 입니다. 해당 게시글이 로그인한 사람이 쓴 글인지를 
확인해 상세보기 화면에 필요한 정보를 넘겨줘야 하기 때문입니다. 또한 Foreign key 때문에 글 작성자
부분에 id가 표현되는데 이 또한 수정해야 합니다. 댓글에 대한 처리는 하지 않았습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">b_detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">board_id</span><span class="p">):</span>

    <span class="n">post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Board</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">board_id</span><span class="p">)</span>

    <span class="n">is_author</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">post</span><span class="o">.</span><span class="n">b_author</span><span class="p">)</span> <span class="o">==</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">:</span>
        <span class="n">is_author</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">post</span><span class="o">.</span><span class="n">b_author</span><span class="p">)</span>

    <span class="n">board_detail_form</span> <span class="o">=</span> <span class="n">BoardDetailForm</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
                                        <span class="n">initial</span><span class="o">=</span><span class="p">{</span><span class="s">'b_author'</span><span class="p">:</span> <span class="n">member</span><span class="p">})</span>

    <span class="n">board_detail_form</span><span class="o">.</span><span class="n">show_board_detail</span><span class="p">()</span>

    <span class="c"># comment 정보도 가져와야 한다.</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">comment_set</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">'-id'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'bbs/detail.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'board_detail_form'</span><span class="p">:</span> <span class="n">board_detail_form</span><span class="p">,</span>
        <span class="s">'comments'</span><span class="p">:</span> <span class="n">comments</span><span class="p">,</span>
        <span class="s">'is_author'</span><span class="p">:</span> <span class="n">is_author</span>
    <span class="p">})</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">forms.py</code> 파일을 살짝 수정해야 합니다. <code class="highlighter-rouge">b_author</code>는 Foreign key로 설정되어 있고 추후에 disabled로 
설정해야 하기 때문에 코드를 수정합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">BoardDetailForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>

    <span class="c"># 각 field를 세부적으로 조정하려면 다음과 같이 widget을 이용해야 한다.</span>
    <span class="c"># b_title = forms.CharField(</span>
    <span class="c">#     label='제목',</span>
    <span class="c">#     widget=forms.TextInput(</span>
    <span class="c">#         attrs={</span>
    <span class="c">#             'class': 'form-control',</span>
    <span class="c">#         }</span>
    <span class="c">#     )</span>
    <span class="c"># )</span>
    <span class="n">b_title</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">'글제목'</span><span class="p">)</span>
    <span class="c"># b_author는 일반 CharField로 설정하면 안됩니다.</span>
    <span class="c"># b_author = forms.CharField(label='글작성자')</span>
    <span class="n">b_content</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">'글내용'</span><span class="p">)</span>
    <span class="n">b_comment_count</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">'댓글수'</span><span class="p">)</span>
    <span class="n">b_like_count</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">'좋아요'</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Board</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="s">'__all__'</span>

    <span class="k">def</span> <span class="nf">show_board_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_fields_from_form</span><span class="p">(</span><span class="n">BoardDetailForm</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s">'readonly'</span><span class="p">:</span> <span class="s">'readonly'</span>
            <span class="p">})</span>

       <span class="c"># 작성자는 수정이 불가능해야 합니다. </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s">'b_author'</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'disabled'</span><span class="p">:</span> <span class="s">'disabled'</span>
        <span class="p">})</span>

    <span class="k">def</span> <span class="nf">show_board_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    
        <span class="c"># 작성자는 수정이 불가능해야 합니다.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s">'b_author'</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'disabled'</span><span class="p">:</span> <span class="s">'disabled'</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s">'b_like_count'</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'readonly'</span><span class="p">:</span> <span class="s">'readonly'</span>
        <span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s">'b_comment_count'</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s">'readonly'</span><span class="p">:</span> <span class="s">'readonly'</span>
        <span class="p">})</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_all_fields_from_form</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">declared_fields</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fields</span>


</code></pre></div></div>

<p>다음은 <code class="highlighter-rouge">detail.html</code> 파일입니다. 자신이 작성한 글에 대해서는 수정 버튼과 삭제 버튼이 활성화 되고 좋아요 버튼은
비활성화 시킵니다. 반대로 자신이 작성한 글이 아닌경우 좋아요 버튼만 활성화 시키는 처리를 하면 될 듯 합니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


{% extends 'base.html' %}
{% load bootstrap4 %}
{% block html_body %}

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/static/js/menu_btn.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>글 상세보기<span class="nt">&lt;/h1&gt;</span>

  번호 : <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"board_id"</span><span class="nt">&gt;</span>{{ board_detail_form.initial.id }}<span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    {% bootstrap_form board_detail_form %}
    <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-success"</span>
          <span class="na">data-board_id=</span><span class="s">"{{ board_detail_form.initial.id }}"</span>
          <span class="na">id=</span><span class="s">"board_list_btn"</span><span class="nt">&gt;</span>리스트로 돌아가기<span class="nt">&lt;/button&gt;</span>
  {% if is_author %}
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-primary"</span>
          <span class="na">data-board_id=</span><span class="s">"{{ board_detail_form.initial.id }}"</span>
          <span class="na">id=</span><span class="s">"board_update_btn"</span><span class="nt">&gt;</span>수정<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-danger"</span>
          <span class="na">data-board_id=</span><span class="s">"{{ board_detail_form.initial.id }}"</span>
          <span class="na">id=</span><span class="s">"board_delete_btn"</span><span class="nt">&gt;</span>삭제<span class="nt">&lt;/button&gt;</span>
  {% else %}
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-warning"</span>
          <span class="na">data-board_id=</span><span class="s">"{{ board_detail_form.initial.id }}"</span>
          <span class="na">id=</span><span class="s">"board_like_btn"</span><span class="nt">&gt;</span>좋아요<span class="nt">&lt;/button&gt;</span>
  {% endif %}

<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;br&gt;&lt;br&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;h3&gt;</span>댓글<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"c_name"</span><span class="nt">&gt;</span>이름<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
           <span class="na">class=</span><span class="s">"form-control"</span>
           <span class="na">id=</span><span class="s">"c_name"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"c_content"</span><span class="nt">&gt;</span>내용<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
           <span class="na">class=</span><span class="s">"form-control"</span>
           <span class="na">id=</span><span class="s">"c_content"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
            <span class="na">class=</span><span class="s">"btn btn-info"</span>
            <span class="na">id=</span><span class="s">"comment_create_btn"</span><span class="nt">&gt;</span>등록<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-hover"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead</span> <span class="na">class=</span><span class="s">"thead-dark"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>글작성자<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>글내용<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">scope=</span><span class="s">"col"</span><span class="nt">&gt;</span>삭제<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody</span> <span class="na">id=</span><span class="s">"comment_body"</span><span class="nt">&gt;</span>
    {% for comment in comments %}
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;td&gt;</span>{{ comment.c_author }}<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>{{ comment.c_content }}<span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;td&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
                <span class="na">class=</span><span class="s">"btn btn-danger"</span>
                <span class="na">data-comment_id=</span><span class="s">"{{ comment.id }}"</span>
                <span class="na">id=</span><span class="s">"comment_delete_btn"</span><span class="nt">&gt;</span>삭제<span class="nt">&lt;/button&gt;</span>
      <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
    {% endfor %}
    <span class="nt">&lt;/tbody&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span>
{% endblock %}



</code></pre></div></div>

<hr />

<p><strong class="subtitle2_fontAwesome">게시판 기능 수정(게시글 수정)</strong></p>

<p>게시글 상세보기에서 수정버튼을 클릭하면 글 내용을 수정할 수 있는 화면으로 전환됩니다. 이때 
글 작성자는 고정되어야 하며 글 제목과 내용만 수정될 수 있도록 처리해야 합니다.</p>

<p>먼저 수정해야 할 파일은 <code class="highlighter-rouge">views.py</code> 파일 입니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">b_update</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Board</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s">'board_id'</span><span class="p">])</span>

    <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>

    <span class="n">board_detail_form</span> <span class="o">=</span> <span class="n">BoardDetailForm</span><span class="p">(</span><span class="n">instance</span><span class="o">=</span><span class="n">post</span><span class="p">,</span>
                                        <span class="n">initial</span><span class="o">=</span><span class="p">{</span><span class="s">'b_author'</span><span class="p">:</span> <span class="n">member</span><span class="p">})</span>
    <span class="n">board_detail_form</span><span class="o">.</span><span class="n">show_board_update</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'bbs/update.html'</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">'board_detail_form'</span><span class="p">:</span> <span class="n">board_detail_form</span>
    <span class="p">})</span>


<span class="k">def</span> <span class="nf">b_update_process</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">board_id</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Board</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">board_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="n">board_detail_form</span> <span class="o">=</span> <span class="n">BoardDetailForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">post</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="n">board_detail_form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">board_detail_form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>

            <span class="n">board_detail_form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">board_detail_form</span><span class="o">.</span><span class="n">show_board_detail</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'bbs/detail.html'</span><span class="p">,</span> <span class="p">{</span>
                <span class="s">'board_detail_form'</span><span class="p">:</span> <span class="n">board_detail_form</span><span class="p">,</span>
                <span class="s">'is_author'</span><span class="p">:</span> <span class="bp">True</span>
            <span class="p">})</span>

</code></pre></div></div>

<p><code class="highlighter-rouge">update.html</code> 파일도 약간 손봐야 합니다. submit button을 jQuery를 이용해서 처리합니다.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


{% extends 'base.html' %}
{% load bootstrap4 %}
{% block html_body %}

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/static/js/menu_btn.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Post Update<span class="nt">&lt;/h1&gt;</span>

  번호 : {{ board_detail_form.initial.id }}
  <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">'{% url '</span><span class="na">bbs:b_update_process</span><span class="err">'</span> <span class="na">board_detail_form</span><span class="err">.</span><span class="na">initial</span><span class="err">.</span><span class="na">id</span> <span class="err">%}'</span>
  <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  {% csrf_token %}
  {# {{ board_detail_form }} #}
  {% bootstrap_form board_detail_form %}
  <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-primary"</span>
          <span class="na">id=</span><span class="s">"board_list_btn"</span><span class="nt">&gt;</span>리스트로 돌아가기<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span>
          <span class="na">class=</span><span class="s">"btn btn-primary"</span>
          <span class="na">id=</span><span class="s">"post_update_btn"</span><span class="nt">&gt;</span>수정적용<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;/div&gt;</span>

{% endblock %}



</code></pre></div></div>

<p><code class="highlighter-rouge">menu_btn.js</code> 파일도 약간 수정해야 합니다.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="c1">// 수정버튼 클릭시</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'#board_update_btn'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">query_string</span> <span class="o">=</span> <span class="s1">'?board_id='</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'data-board_id'</span><span class="p">)</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="s1">'/bbs/update'</span> <span class="o">+</span> <span class="nx">query_string</span>
<span class="p">})</span>

<span class="c1">// 수정적용 버튼 클릭시(실제 수정된 글을 저장하기 위한 submit을 수행할 때)</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">'#post_update_btn'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'#id_b_author'</span><span class="p">).</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">'disabled'</span><span class="p">)</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'form'</span><span class="p">).</span><span class="nx">submit</span><span class="p">()</span>
<span class="p">})</span>


</code></pre></div></div>

<hr />

<p>마지막은 거의 코드 위주로 진행이 됬지만 천천히 살펴보시길 바랍니다. 댓글 역시 자신이 작성한 댓글만 삭제할 수 있도록
처리해야 합니다. 이 구현은 여러분들이 직접 한번 해 보세요!</p>

<p>아래의 링크를 누르면 여기까지 진행한 프로젝트를 다운받으실 수 있습니다.</p>

<p><a href="/assets/downloads/LectureSampleProject.zip" target="_blank">LectureSampleProject</a></p>

<p>End.</p>

<hr />

<p><span class="lecture-reference">Python 강좌는 아래의 책과 사이트를 참조했습니다.
    조금 더 자세한 사항을 알고 싶으시면 해당 사이트를 방문하세요!!</span></p>
<ul class="lecture-reference">
    <li><a href="http://www.python.org/" target="_blank">Python Official HomePage</a></li>
    <li>점프 투 파이썬 - 이지스 퍼블리싱</li>
    <li>전문가를 위한 파이썬(Fluent Python) - 한빛미디어</li>
    <li>파이썬 웹 프로그래밍 - 한빛미디어</li>
    <li>이미지 출처 : <a href="http://www.freepik.com" target="_blank">Designed by rawpixel.com / Freepik</a></li>
</ul>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 기존에 있던 post하단 이메일 subscribe 삭제 -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/moon9342">moon9342</a></h4>
                                
                                    <p><a href="https://www.youtube.com/channel/UCp-MztINXTRVkRGCnqnYNlQ">얼큰우동TV, 쉽게배우는 IT(Programming,Machine Learning,금융)</a></p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/moon9342">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/built/images/blog-cover2.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; IT Technical Training &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/python/">Python</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/python-lecture-python-django-lecture-sample-project_1">Python Django 웹 프레임워크(7) - Lecture Sample project 개발(1)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/python-lecture-python-django-poll-project-5">Python Django 웹 프레임워크(6) - Poll project 개발(5)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/python-lecture-python-django-poll-project-4">Python Django 웹 프레임워크(5) - Poll project 개발(4)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/python/">
                                
                                    See all 22 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/jekyll-start">
                <div class="post-card-image" style="background-image: url(/assets/built/images/jekyll-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/jekyll-start">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Jekyll</span>
                            
                        
                    

                    <h2 class="post-card-title">Jekyll 기반의 GitHub Page 생성(1) - 환경설정</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>{% include jekyll-table-of-contents.html %} --- **영상설명**{: class="subtitle_fontAwesome" } 이번 영상은 `Jekyll`을 이용해 자신의 local 컴퓨터에 기본적인 블로그를 생성하는 방법에 대한 영상입니다. 블로그를 생성하기 위한 Ruby 설치와 [Jasper2](http://jekyllthemes.org/themes/jasper2/){: target="_blank" } blog template 설치 및</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                        
                        <span class="post-card-author">
                            <a href="/author/moon9342/">moon9342</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/python-lecture-python-django-lecture-sample-project_1">
                <div class="post-card-image" style="background-image: url(/assets/built/images/python-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/python-lecture-python-django-lecture-sample-project_1">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Python</span>
                            
                        
                    

                    <h2 class="post-card-title">Python Django 웹 프레임워크(7) - Lecture Sample project 개발(1)</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>Python 기초강의는 여러 절로 구성되어 있습니다. Python 기초강의(1) - Introduction Python 기초강의(2) - Python 기본 Python 기초강의(3) - Python 제어문 Python 기초강의(4) - Python function Python 기초강의(5) - Python 연습문제(1) Python 기초강의(6) -</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                        
                        <span class="post-card-author">
                            <a href="/author/moon9342/">moon9342</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://moon9342.github.io/">
            
            <span>IT Technical Training</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Python Django 웹 프레임워크(8) - Lecture Sample project 개발(2)</div>



    <div class="floating-header-share">
        <div class="floating-header-share-label">이 포스트를 공유하세요 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Python+Django+%EC%9B%B9+%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC%288%29+-+Lecture+Sample+project+%EA%B0%9C%EB%B0%9C%282%29&amp;url=https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://moon9342.github.io/python-lecture-python-django-lecture-sample-project_2"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>


    <!-- floating-header에 이미지 삽입 -->
<!--
    <div class="floating-header-share">
        <img src="assets/images/photo.jpg" width="50">
    </div>
-->

    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->

        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://moon9342.github.io/">IT Technical Training</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/">GitHub Pages</a></section>
                <nav class="site-footer-nav">
                    <a href="mailto:moon9342@gmail.com">moon9342@gmail.com</a>
                    <a href="/">Latest Posts</a>
                    
                    
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Search IT Technical Training</h1>
                <p class="subscribe-overlay-description">lunr.js를 이용한 posts 검색 </p>
                <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" id="searchtext" type="text" name="searchtext"  placeholder="Search..." />
    </div>
    <!--<button class="" onclick="myFunc()" id="searchBtn" type="button" ><span>Search</span></button>-->
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
    <!--<script type="text/et-cetera">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>-->
</span>


            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113135179-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
